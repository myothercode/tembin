<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.base.database.customtrading.mapper.ListingItemReportMapper">
  <resultMap id="BaseResultMap" type="com.base.domains.querypojos.ListingItemReportQuery">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
      <result column="returnType" jdbcType="VARCHAR" property="returnType" />
      <result column="tjNumber" jdbcType="VARCHAR" property="tjNumber" />
  </resultMap>

    <select id="selectListingItemReportList" resultMap="BaseResultMap" parameterType="map">
        select ${datetype} returnType,count(*) tjNumber from trading_listing_success su left JOIN trading_listing_data lid on su.item_id=lid.item_id where 1=1
        <if test="(datetype==1 or datetype==2) and flag==1">
            and DATE_FORMAT(su.start_date, '%Y-%m-%d') = #{datestr}
        </if>
        <if test="(datetype==3 or datetype==4) and flag==1">
            and DATE_FORMAT(su.start_date, '%Y-%m-%d') >= #{startDate} and  #{endDate}>=DATE_FORMAT(su.start_date, '%Y-%m-%d')
        </if>
        <if test="(datetype==5 or datetype==6) and flag==1">
            and DATE_FORMAT(su.start_date, '%Y-%m') = #{datestr}
        </if>

        <if test="(datetype==1 or datetype==2) and flag==2">
            and DATE_FORMAT(su.end_date, '%Y-%m-%d') = #{datestr}
        </if>
        <if test="(datetype==3 or datetype==4) and flag==2">
            and DATE_FORMAT(su.end_date, '%Y-%m-%d') >= #{startDate} and  #{endDate}>=DATE_FORMAT(su.end_date, '%Y-%m-%d')
        </if>
        <if test="(datetype==5 or datetype==6) and flag==2">
            and DATE_FORMAT(su.end_date, '%Y-%m') = #{datestr}
        </if>

        <if test="soldflag!=null">
            and lid.QuantitySold>0
        </if>
    </select>
</mapper>