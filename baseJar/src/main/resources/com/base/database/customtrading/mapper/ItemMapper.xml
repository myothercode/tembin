<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.base.database.customtrading.mapper.ItemMapper">
  <resultMap id="BaseResultMap" type="com.base.domains.querypojos.ItemQuery">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="ApplicationData" jdbcType="VARCHAR" property="applicationdata" />
    <result column="AttributeSetArray" jdbcType="VARCHAR" property="attributesetarray" />
    <result column="AutoPay" jdbcType="VARCHAR" property="autopay" />
    <result column="BestOfferEnabled" jdbcType="VARCHAR" property="bestofferenabled" />
    <result column="CategoryBasedAttributesPrefill" jdbcType="VARCHAR" property="categorybasedattributesprefill" />
    <result column="CategoryMappingAllowed" jdbcType="VARCHAR" property="categorymappingallowed" />
    <result column="ConditionDescription" jdbcType="VARCHAR" property="conditiondescription" />
    <result column="ConditionID" jdbcType="BIGINT" property="conditionid" />
    <result column="Currency" jdbcType="VARCHAR" property="currency" />
    <result column="DisableBuyerRequirements" jdbcType="VARCHAR" property="disablebuyerrequirements" />
    <result column="DispatchTimeMax" jdbcType="BIGINT" property="dispatchtimemax" />
    <result column="eBayNowEligible" jdbcType="VARCHAR" property="ebaynoweligible" />
    <result column="ExternalProductID" jdbcType="VARCHAR" property="externalproductid" />
    <result column="GetItFast" jdbcType="VARCHAR" property="getitfast" />
    <result column="GiftIcon" jdbcType="VARCHAR" property="gifticon" />
    <result column="HitCounter" jdbcType="VARCHAR" property="hitcounter" />
    <result column="IncludeRecommendations" jdbcType="VARCHAR" property="includerecommendations" />
    <result column="InventoryTrackingMethod" jdbcType="VARCHAR" property="inventorytrackingmethod" />
    <result column="ListingDuration" jdbcType="VARCHAR" property="listingduration" />
    <result column="ListingType" jdbcType="VARCHAR" property="listingtype" />
    <result column="LookupAttributeArray" jdbcType="VARCHAR" property="lookupattributearray" />
    <result column="OutOfStockControl" jdbcType="VARCHAR" property="outofstockcontrol" />
    <result column="EligibleForPickupInStore" jdbcType="VARCHAR" property="eligibleforpickupinstore" />
    <result column="PostCheckoutExperienceEnabled" jdbcType="VARCHAR" property="postcheckoutexperienceenabled" />
    <result column="CategoryID" jdbcType="VARCHAR" property="categoryid" />
    <result column="PrivateListing" jdbcType="VARCHAR" property="privatelisting" />
    <result column="PrivateNotes" jdbcType="VARCHAR" property="privatenotes" />
    <result column="Quantity" jdbcType="BIGINT" property="quantity" />
    <result column="MinimumRemnantSet" jdbcType="BIGINT" property="minimumremnantset" />
    <result column="MaximumQuantity" jdbcType="BIGINT" property="maximumquantity" />
    <result column="ScheduleTime" jdbcType="TIMESTAMP" property="scheduletime" />
    <result column="Secondary_CategoryID" jdbcType="VARCHAR" property="secondaryCategoryid" />
    <result column="ShippingTermsInDescription" jdbcType="VARCHAR" property="shippingtermsindescription" />
    <result column="Site" jdbcType="VARCHAR" property="site" />
    <result column="SKU" jdbcType="VARCHAR" property="sku" />
    <result column="SkypeEnabled" jdbcType="VARCHAR" property="skypeenabled" />
    <result column="SkypeID" jdbcType="VARCHAR" property="skypeid" />
    <result column="StartPrice" jdbcType="DOUBLE" property="startprice" />
    <result column="SubTitle" jdbcType="VARCHAR" property="subtitle" />
    <result column="TaxCategory" jdbcType="VARCHAR" property="taxcategory" />
    <result column="Title" jdbcType="VARCHAR" property="title" />
    <result column="UseRecommendedProduct" jdbcType="VARCHAR" property="userecommendedproduct" />
    <result column="UseTaxTable" jdbcType="VARCHAR" property="usetaxtable" />
    <result column="UUID" jdbcType="VARCHAR" property="uuid" />
    <result column="VIN" jdbcType="VARCHAR" property="vin" />
    <result column="VRM" jdbcType="VARCHAR" property="vrm" />
    <result column="create_user" jdbcType="BIGINT" property="createUser" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="local_uuid" jdbcType="VARCHAR" property="localUuid" />
    <result column="item_location_id" jdbcType="BIGINT" property="itemLocationId" />
    <result column="buyer_id" jdbcType="BIGINT" property="buyerId" />
    <result column="pay_id" jdbcType="BIGINT" property="payId" />
    <result column="returnpolicy_id" jdbcType="BIGINT" property="returnpolicyId" />
    <result column="DiscountPriceInfo_id" jdbcType="BIGINT" property="discountpriceinfoId" />
    <result column="Seller_item_info_id" jdbcType="BIGINT" property="sellerItemInfoId" />
    <result column="shipping_deails_id" jdbcType="BIGINT" property="shippingDeailsId" />
    <result column="ebay_account" jdbcType="VARCHAR" property="ebayAccount" />
    <result column="item_name" jdbcType="VARCHAR" property="itemName" />
    <result column="is_flag" jdbcType="VARCHAR" property="isFlag" />
    <result column="item_id" jdbcType="VARCHAR" property="itemId" />
    <result column="site_name" jdbcType="VARCHAR" property="siteName" />
    <result column="listing_way" jdbcType="VARCHAR" property="listingWay" />
    <result column="folder_id" jdbcType="VARCHAR" property="folderId" />
    <result column="galleryURL" jdbcType="VARCHAR" property="galleryURL" />
    <result column="ebayaccountname" jdbcType="VARCHAR" property="ebayaccountname" />
    <result column="site_img" property="siteImg" jdbcType="VARCHAR" />
    <result column="currencyId" property="currencyId" jdbcType="VARCHAR" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
    <result column="defaultTimer" jdbcType="TIMESTAMP" property="defaultTimer" />
  </resultMap>
    <select id="selectByItemList" resultMap="BaseResultMap" parameterType="map">
        select items.*,ebayaccount.ebay_name ebayaccountname from (
        select item.id,item.is_flag,item.item_id,item.remark,item.listingtype,item.listing_way,item.item_name,item.site,item.sku,item.ListingDuration,dic.`name` site_name,dic.imgurl site_img,pic.GalleryURL galleryURL,dic.value1 currencyId,litime.timer defaultTimer,act.ebay_account ebay_name,act.id ebay_id  from trading_item item
        left join trading_data_dictionary dic on item.Site=dic.id
        inner join trading_picturedetails pic on item.id=pic.parent_id
        left join usercontroller_ebay_account act on item.ebay_account=act.id
        left join trading_timer_listing litime on litime.item=item.id
        where 1=1 and item.check_flag='0'
        <!--        <if test="folderid==null">
                    and item.folder_id is null
                </if>-->
        <if test="folderid!=null">
            and item.folder_id = #{folderid}
        </if>
        <if test="id!=null">
            and item.id = #{id}
        </if>
       <!-- <if test="userid!=null">
            and item.create_user = #{userid}
        </if>-->
        <if test="flag==1">
            and item.is_flag = 'Success'
        </if>
        <if test="flag==2">
            and item.is_flag is null
        </if>
        <if test="flag==3">
            and item.listing_way = '1' and litime.check_flag='0' and item.item_id is null and (litime.timer_flag='2' or
            litime.timer_flag is null or litime.timer_flag='0')
        </if>
        <if test="county!=null">
            and item.site = #{county}
        </if>
        <if test="listingtype!=null">
            and item.listingtype = #{listingtype}
        </if>
        <if test="ebayaccount!=null">
            and item.ebay_account = #{ebayaccount}
        </if>
        <if test="selectType!=null">
            and item.${selectType} like CONCAT(CONCAT('%', #{selectValue, jdbcType=VARCHAR}),'%')
        </if>
        ) items left join (select acc.id,acc.ebay_name from usercontroller_ebay_account acc,
        usercontroller_user_ebay dev where acc.id=dev.ebay_id and dev.user_id=#{userid}
        ) ebayaccount on  items.ebay_id=ebayaccount.id
        order by ${descStr} ${desStr}
    </select>


    <select id="selectByEbayIdSiteList" resultMap="BaseResultMap" parameterType="map">
        select site from trading_item where ebay_account=#{ebayAccount} group by site
    </select>

</mapper>