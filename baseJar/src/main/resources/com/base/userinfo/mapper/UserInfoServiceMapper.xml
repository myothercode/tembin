<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.base.userinfo.mapper.UserInfoServiceMapper" >
 <select id="queryUserRole" resultType="com.base.domains.RoleVO" parameterType="map">
    SELECT ur.role_id roleID ,r.role_name roleName from usercontroller_user_role ur
    INNER JOIN usercontroller_role r on ur.role_id=r.role_id
    WHERE ur.user_id=(select u.user_id from usercontroller_user u where u.user_login_id=#{loginId})
 </select>

    <select id="queryPermissionByRoleID" resultType="com.base.domains.PermissionVO" parameterType="map" >
        select p.permission_id permissionID,p.permission_value permissionURL,p.permission_name permissionName from usercontroller_role_permission rp
        INNER JOIN usercontroller_permission p on rp.permission_id=p.permission_id
        where rp.role_id in
        <foreach item="item" index="index" collection="idArray" open="("	separator="," close=")">
            #{item.roleID,jdbcType=DECIMAL}
        </foreach>
    </select>
    
    <select id="querySessionVOInfo" parameterType="com.base.domains.LoginVO" resultType="com.base.domains.SessionVO">
        select u.user_id id,u.user_login_id loginId,
        u.user_name userName,u.user_org_id orgId,org.org_name orgName,
        u.user_parent_id parentId,u.`status`
         from usercontroller_user u
        INNER JOIN usercontroller_org org on org.org_id=u.user_org_id
        where u.user_login_id = #{loginId}   and u.user_password=#{enpassword}
    </select>


</mapper>